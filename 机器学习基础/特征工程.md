# 特征工程

tags: 机器学习

---

![8.数据清洗与特征处理](..\img\8.数据清洗与特征处理.jpg)

## 1. 如何处理数据中的缺失值

有些特征可能因为无法采样或者没有观测值而缺失，此时需要对这些缺失的特征值进行特殊处理。

### 1. 缺失值较多

如果该特征中的缺失值较多，则应该直接舍弃，否则反而可能引入较大噪声，造成反效果。

### 2. 缺失值较少

即当缺失值在 10% 以内时，我们可以采用多种方式处理：

- 将缺失值当一个特征处理，用 一个异常值表示， 如0

  ```
  data_train.fillna(0) 
  ```

- 用均值填充

  通常一个策略是取相同 label 的数据的均值

  ```
  data_train.fillna(data_train.mean()) 
  ```

- 以上下数据填充

  ```
  data_train.fillna(method='pad')  # 上一个数据填充
  data_train.fillna(method='bfill')  # 下一个数据填充
  ```

- 插值法

  ```
  data_train.interpolate() # 即估计中间点的值
  ```

- 用随机森林等算法拟合

  > 将数据分为有值和缺失值2份，对有值的数据采用随机森林拟合，然后对有缺失值的数据进行预测，用预测的值来填充。

## 2.  特征常见处理手段

### 1.数值归一化

归一化的目的是将所有的特征都统一到一个大致相同的数值区间中。

从梯度下降的角度来看，对于两个特征x1，x2， x1的范围远远大于x2，在学习率相同的情况下，x1的更新速度会大于x2，需要较多的迭代才能得到最优解。

![](http://ww1.sinaimg.cn/large/006gOeiSly1g0r7bxl5kfj30ie0a840y.jpg)

- 函数归一化： min-max 归一化， 零均值归一化（参考 **Normalization** 一节）
- 分维度归一化
- 排序归一化

### 2. 离散化

连续值的离散化：

- **等值划分：**将特征按照值域进行均分，每一段内的取值等同处理。例如某个特征的取值范围为[0，10]，我们可以将其划分为10段，[0，1)，[1，2)，...，[9，10)。
- 等量划分是根据样本总数进行均分，每段等量个样本划分为1段。

区别：例如距离特征，取值范围［0，3000000］，现在需要切分成10段，如果按照等比例划分的话，会发现绝大部分样本都在第1段中。使用等量划分就会避免这种问题，最终可能的切分是[0，100)，[100，300)，[300，500)，..，[10000，3000000]，前面的区间划分比较密，后面的比较稀疏。

